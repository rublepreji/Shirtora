<!doctype html>
<html lang="en">
<head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>Orders - UI Mock</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
        /* Keeping original styles */
        body { background: #fff; margin: 0; } 
        .card-border { border: 1px solid rgba(0,0,0,0.35); } 
        .muted { color: #8b8b8b; }
        .purple { color: #7b3fbf; }
        .modal-overlay {
            background-color: rgba(0, 0, 0, 0.6);
            backdrop-filter: blur(2px);
        }
        /* Removed custom @media main-content-offset styles as they are replaced by Tailwind flex utilities */
    </style>
</head>
<%- include("../../view/partials/user/header") %>

<body class="antialiased text-gray-800">
    
    <div class="min-h-screen flex flex-col md:flex-row">

        <%- include("../../view/partials/user/sideBar") %> 

        <main class="flex-1 p-4 sm:p-6 md:p-8">

            <div class="max-w-5xl mx-auto py-4">
                
                <div class="flex justify-end mb-6">
                    <div class="text-sm text-gray-700">Welcome! <span class="font-medium">Customer Name</span></div>
                </div>

                <div class="bg-white shadow-lg rounded-sm p-4 sm:p-8">
                <%orders.forEach((order)=>{%>
                    <div class="space-y-6">
                        <article class="card-border rounded-sm overflow-hidden">
                            
                            <div class="grid grid-cols-2 sm:grid-cols-3 gap-4 items-center px-4 py-3 text-sm bg-gray-50 border-b border-gray-100">
                                <div class="flex flex-col">
                                    <span class="text-xs text-gray-600">Order Placed</span>
                                    <span class="text-sm font-medium mt-1"><%=new Date(order.createdAt).toDateString()%></span>
                                </div>
                                <div class="flex flex-col">
                                    <span class="text-xs text-gray-600">Total</span>
                                    <span class="text-sm font-medium mt-1">₹<%=order.totalAmount%></span>
                                </div>
                                <div class="flex justify-start sm:justify-end items-center col-span-2 sm:col-span-1">
                                    <div class="text-left sm:text-right">
                                        <div class="text-xs text-gray-600">Ship To</div>
                                        <div class="text-sm font-medium"><%=order.address.firstName%></div>
                                    </div>
                                </div>
                            </div>
                           
                            <div class="border-t border-gray-200 p-4 md:flex md:items-start md:space-x-6">
                                 <%order.items.forEach((item,i)=>{%>
                                <div class="w-24 h-24 flex-shrink-0 mx-auto md:mx-0 mb-4 md:mb-0">
                                    <img src="<%=item.productId.productImage[0]%>" alt="product" class="w-full h-full object-cover rounded" />
                                </div>

                                <div class="flex-1 mt-2 md:mt-0 text-center md:text-left">
                                    <h3 class="text-lg font-semibold"><%=item.productId.productName%></h3>
                                    <p class="text-sm mt-2">Price : <span class="font-medium">₹<%=item.productId.variants[item.variantIndex].price%></span></p>
                                   
                                </div>
                                <%})%>
                                <div class="mt-4 md:mt-0 md:w-48 flex flex-col items-center md:items-end md:justify-between space-y-4">
                                    <div class="text-sm text-center md:text-right w-full">
                                        <div class="muted">Order <%=order.orderId%></div>
                                        <div class="mt-3">Status : <span class="font-semibold text-orange-600"><%=order.status%></span></div>
                                    </div>

                                    <div class="flex items-center space-x-3 justify-center md:justify-end w-full">
                                       <a href="/orderdetails/<%=order.orderId%>"><button class="px-3 py-1 text-sm border rounded bg-blue-200 text-blue-700 hover:bg-blue-300 transition">View</button></a>
                                    </div>
                                </div>                      
                            </div>  
                        </article>
                    </div>
                    <%})%>
                </div>
            </div>
            
        </main> 
        </div> 
    <div id="return-modal" class="fixed inset-0 z-50 hidden items-center justify-center modal-overlay transition-opacity duration-300" onclick="if(event.target.id === 'return-modal') hideModal()">
        
        <div class="bg-white rounded-lg shadow-2xl p-6 w-11/12 max-w-sm" onclick="event.stopPropagation()">
            
            <div class="flex justify-between items-center pb-3 border-b border-gray-200 mb-4">
                <h3 class="text-lg font-bold text-gray-800">Reason for Return</h3>
                <button onclick="hideModal()" class="text-gray-500 hover:text-gray-900 transition-colors">
                    <svg class="w-6 h-6" fill="none" stroke="currentColor" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18L18 6M6 6l12 12"></path></svg>
                </button>
            </div>

            <div class="mb-6">
                <textarea id="return-reason" rows="4" class="w-full p-3 border rounded-md focus:ring-1 focus:ring-black focus:border-black transition resize-none text-sm card-border" placeholder="Please explain the reason for your return..."></textarea>
            </div>

            <div class="flex justify-end space-x-3">
                <button onclick="hideModal()" class="px-4 py-2 text-sm border border-gray-300 rounded-md text-gray-700 hover:bg-gray-100 transition">
                    Cancel
                </button>
                <button onclick="sendReturnReason()" class="px-4 py-2 text-sm font-medium rounded-md bg-black text-white hover:bg-gray-800 transition">
                    Send
                </button>
            </div>
        </div>
    </div>

    <script>
        function showModal() {
            const modal = document.getElementById('return-modal');
            modal.classList.remove('hidden');
            modal.classList.add('flex');
            document.body.style.overflow = 'hidden'; 
        }

        function hideModal() {
            const modal = document.getElementById('return-modal');
            modal.classList.remove('flex');
            modal.classList.add('hidden');
            document.body.style.overflow = ''; 
        }

        function sendReturnReason() {
            const reason = document.getElementById('return-reason').value;
            console.log('Return Reason Submitted:', reason);
            document.getElementById('return-reason').value = ''; 
            hideModal();
            console.log("Return request submitted successfully!");
        }
    </script>
    
</body>
<%- include("../../view/partials/user/footer") %>
</html>